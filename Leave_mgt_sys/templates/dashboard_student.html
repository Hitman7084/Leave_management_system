{% extends "base.html" %}
{% load static %}
{% block title %}Student Dashboard{% endblock %}

{% block sidebar %}
<div class="sidenav">
    <a href="{% url 'dashboard_student' %}">
        <span class="icon"><i class="fas fa-home"></i></span>
        <span class="text">Home</span>
    </a>
    <a href="{% url 'student_profile' %}">
        <span class="icon"><i class="fa-solid fa-user"></i></span>
        <span class="text">Profile</span>
    </a>
    <a href="{% url 'student_form' %}">
        <span class="icon"><i class="fa-solid fa-file"></i></span>
        <span class="text">Leave form</span>
    </a>
    <a href="#">
        <span class="icon"><i class="fa-solid fa-clock-rotate-left"></i></span>
        <span class="text">Leave history</span>
    </a>
    <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button class="logout-btn">
            <span class="icon"><i class="fa-solid fa-right-from-bracket"></i></span>
            <span class="text">Logout</span>
        </button>
    </form>
</div>
{% endblock %}

{% block content %}
<div class="main-content">
    <h1>Welcome {{ user.full_name }} and fk you</h1>
    <section class="stats">
        <div class="chart-container">
            <h3>Weekly Leave Pattern</h3>
            <canvas id="weeklyChart"></canvas>
        </div>
        <div class="chart-container">
            <h3>Monthly Leave Pattern</h3>
            <canvas id="monthlyChart"></canvas>
        </div>
    </section>
    
    <section class="leave-cards">
        <div class="card sick-leave">
            <h4>Sick Leave</h4>
            <p>Available: 08</p>
            <p>Consumed: 12</p>
        </div>
        <div class="card earned-leave">
            <h4>Earned Leave</h4>
            <p>Available: 03</p>
            <p>Consumed: 03</p>
        </div>
        <div class="card casual-leave">
            <h4>Casual Leave</h4>
            <p>Available: 03</p>
            <p>Consumed: 03</p>
        </div>
        <div class="card unpaid-leave">
            <h4>Unpaid Leave</h4>
            <p>Available: Unlimited</p>
            <p>Consumed: Unlimited</p>
        </div>
        <div class="card floater-leave">
            <h4>Floater Leave</h4>
            <p>Available: 03</p>
            <p>Consumed: 03</p>
        </div>
    </section>
    <p>Number of Incharges: {{ incharges|length }}</p> <!-- Debug code -->
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const weeklyCtx = document.getElementById("weeklyChart").getContext("2d");
        new Chart(weeklyCtx, {
            type: "bar",
            data: {
                labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
                datasets: [{
                    label: "Leaves",
                    data: [2, 10, 4, 7, 2, 1, 1],
                    backgroundColor: "#2f80ed"
                }]
            }
        });
    
        const monthlyCtx = document.getElementById("monthlyChart").getContext("2d");
        new Chart(monthlyCtx, {
            type: "line",
            data: {
                labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                datasets: [{
                    label: "Leave Count",
                    data: [1, 3, 5, 6, 7, 9, 3, 6, 4, 7, 2, 8],
                    borderColor: "#2f80ed",
                    fill: false
                }]
            }
        });
    });
</script>

{% endblock %}
