{% extends "base.html" %}
{% load static %}
{% block title %}Student Dashboard{% endblock %}

{% block sidebar %}
<div class="sidenav">
    <a href="{% url 'dashboard_student' %}">
        <span class="icon">
            <img src="{% static 'svg/house-solid.svg' %}" style="width: 1.2em; height: 1.2em;">
        </span>
        <span class="text">Home</span>
    </a>
    <a href="{% url 'student_profile' %}">
        <span class="icon">
            <img src="{% static 'svg/user-solid.svg' %}" style="width: 1.2em; height: 1.2em;">
        </span>
        <span class="text">Profile</span>
    </a>
    <a href="{% url 'student_form' %}">
        <span class="icon">
            <img src="{% static 'svg/file-solid.svg' %}" style="width: 1.2em; height: 1.2em;">
        </span>
        <span class="text">Form</span>
    </a>
    <a href="{% url 'student_history' %}">
        <span class="icon">
            <img src="{% static 'svg/clock-rotate-left-solid.svg' %}" style="width: 1.2em; height: 1.2em;">
        </span>
        <span class="text">History</span>
    </a>
    <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button class="logout-btn">
            <span class="icon">
                <img src="{% static 'svg/right-from-bracket-solid.svg' %}" style="width: 1.2em; height: 1.2em;">
            </span>
            <span class="text">Logout</span>
        </button>
    </form>
</div>
{% endblock %}

{% block content %}
<div class="main-content">
    <h1>Welcome {{ user.full_name }} </h1>
    <div class="graph">
        <h2>Available Leaves</h2>
        <canvas id="leaveChart" width="400" height="200"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const leaveData = {
        labels: ['Casual', 'Duty', 'Medical', 'Emergency'],
        datasets: [{
            label: 'Remaining Leaves',
            data: [
                {{ leave_data.casual }},
                {{ leave_data.duty }},
                {{ leave_data.medical }},
                {{ leave_data.emergency }}
            ],
            backgroundColor: ['#3498db', '#2ecc71', '#e74c3c', '#f1c40f'],
            borderWidth: 1
        }]
    };

    const config = {
        type: 'bar',
        data: leaveData,
        options: {
            responsive: true,
            plugins: {
                legend: { display: false },
                title: { display: true, text: 'Your Leave Balance' }
            }
        }
    };

    new Chart(document.getElementById('leaveChart'), config);
</script>

{% endblock %}
