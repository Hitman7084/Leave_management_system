{% extends "base.html" %}
{% load static %}
{% block title %}Student Dashboard{% endblock %}

{% block content %}
<div class="student-dashboard-container">
    <aside class="student-sidebar">
        <h2 class="student-logo">YOUR LOGO</h2>
        <nav class="student-menu">
            <ul>
                <li><a href="#">Dashboard</a></li>
                <li><a href="#">Profile</a></li>
                <li class="active"><a href="#">Leave</a></li>
                <li><a href="#">Documents</a></li>
                <li><a href="#">Performance</a></li>
                <li><a href="#">Payroll</a></li>
                <li><a href="#">Support</a></li>
                <li><a href="#">Settings</a></li>
            </ul>
        </nav>
    </aside>

    <main class="student-dashboard-content">
        <header class="student-dashboard-header">
            <h1>Leave Management</h1>
            <button class="student-btn-request">Request Leave</button>
        </header>

        <section class="student-leave-summary">
            <div class="student-leave-card">15<br><span>Annual Leave Remaining</span></div>
            <div class="student-leave-card">01<br><span>Sick Leave Taken</span></div>
            <div class="student-leave-card">04<br><span>Other Leave Taken</span></div>
        </section>

        <section class="student-calendar">
            <h2>Calendar Overview</h2>
            <div class="calendar-controls">
                <button id="prev-month">&#8249;</button>
                <span id="current-month-year"></span>
                <button id="next-month">&#8250;</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
                    </tr>
                </thead>
                <tbody id="calendar-body"></tbody>
            </table>
        </section>

        <section class="student-leave-application">
            <h2>Leave Application</h2>
            <form id="student-form">
                <label for="subject">Subject:</label>
                <input type="text" id="subject" name="subject" required>
                <label for="message">Message:</label>
                <textarea id="message" name="message" required></textarea>
                <label for="attachment">Attachment:</label>
                <input type="file" id="attachment" name="attachment">
                <button type="submit">Submit</button>
            </form>
        </section>

        <section class="student-upcoming-holidays">
            <h2>Upcoming Public Holidays</h2>
            <ul id="holiday-list"></ul>
        </section>
    </main>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const calendarBody = document.getElementById("calendar-body");
        const currentMonthYear = document.getElementById("current-month-year");
        const prevMonthBtn = document.getElementById("prev-month");
        const nextMonthBtn = document.getElementById("next-month");
        const holidayList = document.getElementById("holiday-list");
        
        let currentDate = new Date();
        
        function renderCalendar(month, year) {
            calendarBody.innerHTML = "";
            let firstDay = new Date(year, month, 1).getDay();
            let daysInMonth = new Date(year, month + 1, 0).getDate();
            
            currentMonthYear.textContent = new Intl.DateTimeFormat('en-US', { month: 'long', year: 'numeric' }).format(new Date(year, month));
            
            let row = document.createElement("tr");
            for (let i = 0; i < firstDay; i++) {
                row.appendChild(document.createElement("td"));
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                let cell = document.createElement("td");
                cell.textContent = day;
                if (day === new Date().getDate() && month === new Date().getMonth() && year === new Date().getFullYear()) {
                    cell.classList.add("today");
                }
                row.appendChild(cell);
                if ((day + firstDay) % 7 === 0) {
                    calendarBody.appendChild(row);
                    row = document.createElement("tr");
                }
            }
            calendarBody.appendChild(row);
        }
        
        prevMonthBtn.addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar(currentDate.getMonth(), currentDate.getFullYear());
        });
        
        nextMonthBtn.addEventListener("click", () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar(currentDate.getMonth(), currentDate.getFullYear());
        });
        
        function loadHolidays() {
            const holidays = [
                { date: "2025-04-22", name: "Eid al-Fitr" },
                { date: "2025-05-01", name: "Labour Day" },
                { date: "2025-07-30", name: "Islamic New Year" },
            ];
            holidayList.innerHTML = "";
            holidays.forEach(holiday => {
                let li = document.createElement("li");
                li.textContent = `${holiday.date} - ${holiday.name}`;
                holidayList.appendChild(li);
            });
        }
        
        renderCalendar(currentDate.getMonth(), currentDate.getFullYear());
        loadHolidays();
    });
</script>

{% endblock %}
